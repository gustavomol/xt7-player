' Gambas class file

Public NewEq As String

Public Sub SlidersFreq_Change()
  Dim Theslider, TheTextbox As Object
  Dim params As String = ""
  Dim i As Integer = 0
  For Each Theslider In AudioEqualizer.controls
    If Theslider Is Slider Then
      params = params & (12 - TheSlider.value - 12) & ":"
      TheTextbox = valuescontainer.children[i]
      TheTextbox.text = (12 - TheSlider.value - 12)
      i = i + 1
    Endif
  Next 'slider
  params = Left$(params, Len(params) - 1)
  NewEq = "equalizer=" & params
  Try FMain.mplayer.Send("af_del equalizer")
  Try FMain.mplayer.Send("af_add " & NewEq)
  'PRINT out
End
